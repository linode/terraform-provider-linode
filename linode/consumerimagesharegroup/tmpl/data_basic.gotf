{{ define "consumer_image_share_group_data_basic" }}

resource "linode_producer_image_share_group" "foobar" {
  provider                       = linode-producer
  label                          = "{{ .ShareGroupLabel }}"
  description                    = "Example description"
}

resource "linode_consumer_image_share_group_token" "foobar" {
  provider                       = linode-consumer
  depends_on                     = [linode_producer_image_share_group.foobar]
  valid_for_sharegroup_uuid      = linode_producer_image_share_group.foobar.uuid
  label                          = "{{ .TokenLabel }}"
}

resource "linode_producer_image_share_group_member" "foobar" {
  provider                       = linode-producer
  depends_on                     = [linode_producer_image_share_group.foobar, linode_consumer_image_share_group_token.foobar]
  sharegroup_id                  = linode_producer_image_share_group.foobar.id
  token                          = linode_consumer_image_share_group_token.foobar.token
  label                          = "{{ .MemberLabel }}"
}

data "linode_consumer_image_share_group" "foobar" {
  provider                       = linode-consumer
  depends_on                     = [linode_producer_image_share_group_member.foobar]
  token_uuid                     = linode_consumer_image_share_group_token.foobar.token_uuid
}

{{ end }}